<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vid to GIF</title>
    <script src="https://cdn.jsdelivr.net/npm/lzw-stream@1.0.0/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/neuquant-js@0.2.1/helpers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gifencoder@2.0.1/index.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/base64-js@1.5.1/base64js.min.js"></script>
  </head>
  <body>
    <canvas id="bitmap" width="200" height="100"></canvas>
    <script>
      var canvas = document.getElementById("bitmap");
      var context = canvas.getContext("2d");
      context.fillStyle = "rgb(255,255,255)";
      context.fillRect(0, 0, canvas.width, canvas.height); //GIF can't do transparent, so set white background.

      context.fillStyle = "rgb(200,0,0)";
      context.fillRect(10, 10, 75, 50);

      var encoder = new GIFEncoder();
      encoder.setRepeat(0); // 0 -> loop forever
      encoder.setDelay(500); // Delay between frames in ms
      encoder.start();
      encoder.addFrame(context);
      encoder.finish();

      var binary_gif = encoder.stream().getData(); // Get binary GIF data
      var base64_gif = base64js.fromByteArray(binary_gif); // Convert binary data to base64

      // Create a data URL for the GIF
      var data_url = "data:image/gif;base64," + base64_gif;

      // Display the GIF image
      var img = document.createElement("img");
      img.src = data_url;
      document.body.appendChild(img);
    </script>
  </body>
</html>